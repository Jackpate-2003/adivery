{"version":3,"sources":["adivery-banner-ad-view.tsx"],"names":["Banner","LargeBanner","MediumRectangle","React","PixelRatio","requireNativeComponent","NativeEventEmitter","StyleSheet","NativeModules","ComponentName","RCTAdiveryBanner","AdiveryBanner","Component","constructor","props","create","container","justifyContent","_onAdLoaded","bind","_onAdClicked","_onError","onAdLoaded","onAdClicked","onError","componentDidMount","eventEmmiter","Adivery","adLoadSubscription","addListener","BANNER_LOADED_EVENT","event","placementId","adClickedSubscription","BANNER_CLICKED_EVENT","adErrorSubscription","BANNER_ERROR_EVENT","message","componentWillUnmount","remove","render","width","_getWidth","height","_getHeight","bannerSize","dpi","_getScreenDpi","ratio","get"],"mappings":"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","sourcesContent":["import { Banner, LargeBanner, MediumRectangle } from './banner-size';\nimport React from 'react';\nimport { EmitterSubscription, PixelRatio } from 'react-native';\nimport {\n  requireNativeComponent,\n  NativeEventEmitter,\n  StyleSheet,\n} from 'react-native';\nimport { NativeModules } from 'react-native';\n\nconst ComponentName = 'AdiveryBannerAdView';\n\ntype BannerProps = {\n  style: any;\n  placementId: string;\n  bannerSize: number;\n};\n\nconst RCTAdiveryBanner = requireNativeComponent<BannerProps>(ComponentName);\n\ntype RCTBannerProps = {\n  placementId: string;\n  bannerSize: number;\n  onAdLoaded: () => void;\n  onAdClicked: () => void;\n  onError: (message: string) => void;\n};\n\nclass AdiveryBanner extends React.Component<RCTBannerProps> {\n  onAdLoaded: () => void;\n  onAdClicked: () => void;\n  onError: (message: string) => void;\n\n  adLoadSubscription?: EmitterSubscription;\n  adClickedSubscription?: EmitterSubscription;\n  adErrorSubscription?: EmitterSubscription;\n\n  BANNER_LOADED_EVENT = 'AdiveryBannerLoaded';\n  BANNER_CLICKED_EVENT = 'AdiveryBannerClicked';\n  BANNER_ERROR_EVENT = 'AdiveryBannerError';\n\n  props: RCTBannerProps;\n\n  constructor(props: RCTBannerProps) {\n    super(props);\n    this.props = props;\n    this._onAdLoaded = this._onAdLoaded.bind(this);\n    this._onAdClicked = this._onAdClicked.bind(this);\n    this._onError = this._onError.bind(this);\n    this.onAdLoaded = props.onAdLoaded;\n    this.onAdClicked = props.onAdClicked;\n    this.onError = props.onError;\n  }\n\n  componentDidMount() {\n    const eventEmmiter = new NativeEventEmitter(NativeModules.Adivery);\n    this.adLoadSubscription = eventEmmiter.addListener(\n      this.BANNER_LOADED_EVENT,\n      (event) => {\n        if (event.placementId == this.props.placementId) {\n          this._onAdLoaded();\n        }\n      }\n    );\n    this.adClickedSubscription = eventEmmiter.addListener(\n      this.BANNER_CLICKED_EVENT,\n      (event) => {\n        if (event.placementId == this.props.placementId) {\n          this._onAdClicked();\n        }\n      }\n    );\n    this.adErrorSubscription = eventEmmiter.addListener(\n      this.BANNER_ERROR_EVENT,\n      (event) => {\n        if (event.placementId == this.props.placementId) {\n          this._onError(event.message);\n        }\n      }\n    );\n  }\n\n  componentWillUnmount() {\n    this.adLoadSubscription?.remove();\n    this.adClickedSubscription?.remove();\n    this.adErrorSubscription?.remove();\n  }\n\n  _onAdLoaded() {\n    if (!this.onAdLoaded) {\n      return;\n    }\n    this.onAdLoaded();\n  }\n\n  _onAdClicked() {\n    if (!this.onAdClicked) {\n      return;\n    }\n    this.onAdClicked();\n  }\n\n  _onError(message: string) {\n    if (!this.onError) {\n      return;\n    }\n    this.onError(message);\n  }\n\n  render() {\n    return (\n      <RCTAdiveryBanner\n        style={{ width: this._getWidth(), height: this._getHeight() }}\n        placementId={this.props.placementId}\n        bannerSize={this.props.bannerSize}\n      />\n    );\n  }\n\n  style = StyleSheet.create({\n    container: {\n      justifyContent: 'center',\n    },\n  });\n\n  _getWidth() {\n    switch (this.props.bannerSize) {\n      case Banner:\n        return 320;\n      case LargeBanner:\n        return 320;\n      case MediumRectangle:\n        return 300;\n    }\n    return '100%';\n  }\n\n  _getHeight() {\n    switch (this.props.bannerSize) {\n      case Banner:\n        return 50;\n      case LargeBanner:\n        return 100;\n      case MediumRectangle:\n        return 250;\n    }\n    const dpi = this._getScreenDpi();\n    if (dpi <= 240) {\n      return 50;\n    }\n    return 90;\n  }\n\n  _getScreenDpi() {\n    const ratio = PixelRatio.get();\n    const dpi = ratio * 160;\n    return dpi;\n  }\n}\n\nexport default AdiveryBanner;\n"]}